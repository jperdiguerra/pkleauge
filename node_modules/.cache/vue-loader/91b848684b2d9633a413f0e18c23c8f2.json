{"remainingRequest":"/Users/jp/workspace/pklgue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jp/workspace/pklgue/src/components/PriceList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jp/workspace/pklgue/src/components/PriceList.vue","mtime":1597549846491},{"path":"/Users/jp/workspace/pklgue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jp/workspace/pklgue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/jp/workspace/pklgue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jp/workspace/pklgue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQcmljZUl0ZW0gZnJvbSAnLi9QcmljZUl0ZW0nOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJQcmljZUxpc3QiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBuYW1lOiAnVXMnLAogICAgICByb3VuZFRvT25lOiBbJ1VTRCcsICdTR0QnLCAnQ05ZJ10sCiAgICAgIHJvdW5kVG9IdW5kcmVkOiBbJ0tSVycsICdKUFknLCAnSURSJ10KICAgIH07CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBQcmljZUl0ZW0KICB9LAogIHByb3BzOiB7CiAgICBwcmljZXM6IE9iamVjdCwKICAgIGN1cnJlbmN5OiBTdHJpbmcKICB9LAogIGNvbXB1dGVkOiB7CiAgICBjb21wZXRpdG9ycygpIHsKICAgICAgcmV0dXJuIHRoaXMucHJpY2VzICYmIHRoaXMucHJpY2VzLmNvbXBldGl0b3JzID8gdGhpcy5wcmljZXMuY29tcGV0aXRvcnMgOiBudWxsOyAKICAgIH0sCiAgICBvdXJQcmljZSgpIHsKICAgICAgcmV0dXJuIHRoaXMucHJpY2VzID8gdGhpcy5yb3VuZEFtb3VudCh0aGlzLnByaWNlcy5wcmljZSkgOiAwOwogICAgfSwKICAgIHNvcnRlZFByaWNlcygpIHsKICAgICAgaWYoIXRoaXMuY29tcGV0aXRvcnMpIHJldHVybiBbXTsKICAgICAgbGV0IGFsbCA9IE9iamVjdC5lbnRyaWVzKHRoaXMuY29tcGV0aXRvcnMpOwogICAgICBhbGwucHVzaChbdGhpcy5uYW1lLCB0aGlzLm91clByaWNlLCB0cnVlXSk7CiAgICAgIGxldCBzb3J0ZWQgPSBhbGwuc29ydCgoYSwgYikgPT4gKGFbMV0gPiBiWzFdKSA/IDEgOiAtMSk7CiAgICAgIHJldHVybiBzb3J0ZWQ7CiAgICB9LAogICAgcGVyY2VudFNhdmluZ3MoKSB7CiAgICAgIGlmKCF0aGlzLmNvbXBldGl0b3JzKSByZXR1cm4gW107CiAgICAgIGxldCBwZXJjZW50U2F2aW5ncyA9IFtdOwogICAgICBmb3IoY29uc3QgY29tcGV0aXRvciBpbiB0aGlzLmNvbXBldGl0b3JzKSB7CiAgICAgICAgbGV0IGNvbXBldGl0b3JQcmljZSA9IHRoaXMuY29tcGV0aXRvcnNbY29tcGV0aXRvcl0KICAgICAgICBpZihjb21wZXRpdG9yUHJpY2UgPiB0aGlzLm91clByaWNlKSB7CiAgICAgICAgICBsZXQgZGlmZiA9IGNvbXBldGl0b3JQcmljZSAtIHRoaXMub3VyUHJpY2U7CiAgICAgICAgICBsZXQgc2F2aW5ncyA9ICgoZGlmZi90aGlzLm91clByaWNlKSAqIDEwMCkudG9GaXhlZCgyKTsKICAgICAgICAgIHBlcmNlbnRTYXZpbmdzLnB1c2goe2NvbXBldGl0b3IsIHNhdmluZ3N9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHBlcmNlbnRTYXZpbmdzOwogICAgfSwKICAgIHByaWNlRGlzcGxheSgpIHsKICAgICAgcmV0dXJuIHRoaXMucHJpY2VzID8gYCR7dGhpcy5jdXJyZW5jeX0gJHt0aGlzLm91clByaWNlfWAgOiAnUmF0ZXMgdW5hdmFpbGFibGUnOwogICAgfSwKICAgIHdpdGhTYXZpbmdzKCkgewogICAgICByZXR1cm4gdGhpcy5wZXJjZW50U2F2aW5ncy5sZW5ndGggPiAwOwogICAgfSwKICAgIHRheGVzQW5kRmVlcygpIHsKICAgICAgcmV0dXJuIHRoaXMucHJpY2VzID8gdGhpcy5wcmljZXMudGF4ZXNfYW5kX2ZlZXMgOiBudWxsOwogICAgfSwKICAgIHRheGVzQW5kRmVlc1Rvb2x0aXAoKSB7CiAgICAgIGlmKCF0aGlzLnRheGVzQW5kRmVlcykgcmV0dXJuICcnOwogICAgICByZXR1cm4gYFRheDogJHt0aGlzLnRheGVzQW5kRmVlcy50YXh9PGJyPiBIb3RlbCBmZWVzOiAke3RoaXMudGF4ZXNBbmRGZWVzLmhvdGVsX2ZlZXN9YDsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGlzTGFzdEl0ZW0oaW5kZXgpIHsKICAgICAgcmV0dXJuIHRoaXMuc29ydGVkUHJpY2VzLmxlbmd0aCAtIDEgPT0gaW5kZXg7CiAgICB9LAogICAgcm91bmRBbW91bnQoYW1vdW50KSB7CiAgICAgIGlmKHRoaXMucm91bmRUb09uZS5pbmNsdWRlcyh0aGlzLmN1cnJlbmN5KSkgcmV0dXJuIE1hdGgucm91bmQoYW1vdW50KTsKICAgICAgaWYodGhpcy5yb3VuZFRvSHVuZHJlZC5pbmNsdWRlcyh0aGlzLmN1cnJlbmN5KSkgcmV0dXJuIChNYXRoLnJvdW5kKGFtb3VudC8xMDApICogMTAwKTsKICAgICAgcmV0dXJuIGFtb3VudDsKICAgIH0KICB9Cn0K"},{"version":3,"sources":["PriceList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PriceList.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div>\n    <div class=\"bg-success price\">\n      <strong>{{ priceDisplay }}</strong><sup v-if=\"taxesAndFees\">*</sup>\n      <div class=\"tax-fees\" name=\"tax-fees\"\n        v-if=\"taxesAndFees\"\n        v-tooltip.top-center=\"taxesAndFeesTooltip\"\n      >\n        * Price includes taxes and fees!\n      </div>\n    </div>\n\n    <template v-if=\"withSavings\">\n      <div\n        class=\"savings\"\n        v-for=\"percentSaving in percentSavings\"\n        :key=\"percentSaving.competitor\"\n      >\n        <strong>\n          <u>{{ `Save ${percentSaving.savings}% vs ${percentSaving.competitor}` }}</u>\n        </strong>\n      </div>\n    </template>\n    <PriceItem\n      v-for=\"(price, index) in sortedPrices\"\n      :key=\"index\"\n      :name=\"price[0]\"\n      :value=\"roundAmount(price[1])\"\n      :competitor=\"!price[2]\"\n      :currency=\"currency\"\n      :lastItem='isLastItem(index)'\n    >\n    </PriceItem>\n  </div>\n</template>\n\n<script>\nimport PriceItem from './PriceItem';\n\nexport default {\n  name: \"PriceList\",\n  data() {\n    return {\n      name: 'Us',\n      roundToOne: ['USD', 'SGD', 'CNY'],\n      roundToHundred: ['KRW', 'JPY', 'IDR']\n    };\n  },\n  components: {\n    PriceItem\n  },\n  props: {\n    prices: Object,\n    currency: String\n  },\n  computed: {\n    competitors() {\n      return this.prices && this.prices.competitors ? this.prices.competitors : null; \n    },\n    ourPrice() {\n      return this.prices ? this.roundAmount(this.prices.price) : 0;\n    },\n    sortedPrices() {\n      if(!this.competitors) return [];\n      let all = Object.entries(this.competitors);\n      all.push([this.name, this.ourPrice, true]);\n      let sorted = all.sort((a, b) => (a[1] > b[1]) ? 1 : -1);\n      return sorted;\n    },\n    percentSavings() {\n      if(!this.competitors) return [];\n      let percentSavings = [];\n      for(const competitor in this.competitors) {\n        let competitorPrice = this.competitors[competitor]\n        if(competitorPrice > this.ourPrice) {\n          let diff = competitorPrice - this.ourPrice;\n          let savings = ((diff/this.ourPrice) * 100).toFixed(2);\n          percentSavings.push({competitor, savings});\n        }\n      }\n      return percentSavings;\n    },\n    priceDisplay() {\n      return this.prices ? `${this.currency} ${this.ourPrice}` : 'Rates unavailable';\n    },\n    withSavings() {\n      return this.percentSavings.length > 0;\n    },\n    taxesAndFees() {\n      return this.prices ? this.prices.taxes_and_fees : null;\n    },\n    taxesAndFeesTooltip() {\n      if(!this.taxesAndFees) return '';\n      return `Tax: ${this.taxesAndFees.tax}<br> Hotel fees: ${this.taxesAndFees.hotel_fees}`;\n    }\n  },\n  methods: {\n    isLastItem(index) {\n      return this.sortedPrices.length - 1 == index;\n    },\n    roundAmount(amount) {\n      if(this.roundToOne.includes(this.currency)) return Math.round(amount);\n      if(this.roundToHundred.includes(this.currency)) return (Math.round(amount/100) * 100);\n      return amount;\n    }\n  }\n}\n</script>\n\n<style scoped>\nsup {\n  top: -4px;\n}\n\n.price {\n  color: white;\n  padding: 10px;\n  font-size: x-large;\n  width: 200px;\n}\n\n.tax-fees {\n  font-size: small;\n}\n\n[data-popover='tax-fees'] {\n  background: #444;\n  color: red;\n\n  font-size: 12px;\n  line-height: 1.5;\n  margin: 5px;\n}\n</style>\n"]}]}